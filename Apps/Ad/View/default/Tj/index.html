<include file="Public:header" />
<div class="container">
    
    <div class="mt30 mb20 bg_white">
        <div class="layui-tab layui-tab-card">
            <ul class="layui-tab-title">
                <li <if condition='ACTION_NAME EQ "index"'>class="layui-this"</if>><a href="{:U('Tj/index')}">总揽</a></li>
                <li <if condition='ACTION_NAME EQ "sucai"'>class="layui-this"</if>><a href="{:U('Tj/jcdata')}">基础数据</a></li>
                <li <if condition='ACTION_NAME EQ "live"'>class="layui-this"</if>><a href="{:U('Tj/live')}">实时数据</a></li>              
            </ul>
            <div class="layui-tab-content p20">
            	<div class="fr"><a href="{:U('Tj/index')}"                      class="layui-btn layui-btn-small <if condition="$_GET['device'] neq 'pc' and $_GET['device'] neq 'wap'">layui-btn-danger<else/>layui-btn-primary</if> mt20 mr5">全部</a></div>
            	<div class="fr"><a href="{:U('Tj/index',['device' => 'wap'])}"  class="layui-btn layui-btn-small <if condition="$_GET['device'] eq 'wap'">layui-btn-danger<else/>layui-btn-primary</if> mt20 mr5">移动端</a></div>            
            	<div class="fr"><a href="{:U('Tj/index',['device' => 'pc'])}"   class="layui-btn layui-btn-small <if condition="$_GET['device'] eq 'pc'">layui-btn-danger<else/>layui-btn-primary</if> mt20 mr5">PC</a></div>
                <!-- 内容 -->
                <div class="mt50 mb20">
			        <div class="mt20 mb5">
			            <div class="fs14"><strong>昨日数据</strong></div>
			        </div>
			        <table class="layui-table bg-white bor_der" lay-skin="nob">
			            <tr>
			                <th class="text-left text-gray" style="border: 0;">&nbsp;</th>
			                <th class="text-left text-gray" style="border: 0;">展现量</th>
			                <th class="text-left text-gray" style="border: 0;">点击量</th>
			                <th class="text-left text-gray" style="border: 0;">点击率（%）</th>
			                <th class="text-left text-gray" style="border: 0;">成交笔数</th>
			                <th class="text-left text-gray" style="border: 0;">成交金额（元）</th>
			                <th class="text-left text-gray" style="border: 0;">转化率（%）</th>
			            </tr>
			            <tr style="font-weight: normal;">
			                <td class="text-center h50 text-gray" style="border: 0;">昨日</td>
			                <td class="text-left" style="border: 0;">	<strong class="fs18 pl5">{$tjTwoDay[0].show|default='0'}</strong>
			                   	<php>
			                   		$show=$tjTwoDay[0]['show']-$tjTwoDay[1]['show'];
			                   		if($show==0||!$tjTwoDay[1]['show']){
			                   			
			                   		}elseif($show>0){
			                   			echo '<strong class="fs12" style="color: red;">↑';
			                   			echo round($show/$tjTwoDay[1]['show']*100,2).'%</strong>';
			                   		}else{
			                   			echo '<strong class="fs12" style="color: green;">↓';
			                   			echo round($show/$tjTwoDay[1]['show']*100,2).'%</strong>';
			                   		}
			                   	</php>
			                </td>
			                <td class="text-left" style="border: 0;">	<strong class="fs18 pl5">{$tjTwoDay[0].hit|default='0'}</strong>
			                   	<php>
			                   		$hit=$tjTwoDay[0]['hit']-$tjTwoDay[1]['hit'];
			                   		if($hit==0||!$tjTwoDay[1]['hit']){
			                   			
			                   		}elseif($hit>0){
			                   			echo '<strong class="fs12" style="color: red;">↑';
			                   			echo round($hit/$tjTwoDay[1]['hit']*100,2).'%</strong>';
			                   		}else{
			                   			echo '<strong class="fs12" style="color: green;">↓';
			                   			echo round($hit/$tjTwoDay[1]['hit']*100,2).'%</strong>';
			                   		}
			                   	</php>
			                </td>
			                <td class="text-left" style="border: 0;">	<strong class="fs18 pl5"><php>echo round($tjTwoDay[0]['hit']/$tjTwoDay[0]['show']*100,2);</php>%</strong>
			                    <php>
			                   		$hitc=($tjTwoDay[0]['hit']/$tjTwoDay[0]['show'])-($tjTwoDay[1]['hit']/$tjTwoDay[1]['show']);
			                   		if($hitc==0||!($tjTwoDay[1]['hit']/$tjTwoDay[1]['show'])){
			                   			
			                   		}elseif($hitc>0){
			                   			echo '<strong class="fs12" style="color: red;">↑';
			                   			echo round($hitc/($tjTwoDay[1]['hit']/$tjTwoDay[1]['show'])*100,2).'%</strong>';
			                   		}else{
			                   			echo '<strong class="fs12" style="color: green;">↓';
			                   			echo round($hitc/($tjTwoDay[1]['hit']/$tjTwoDay[1]['show'])*100,2).'%</strong>';
			                   		}
			                   	</php>
			                </td>
			                <td class="text-left" style="border: 0;">	<strong class="fs18 pl5">{$tjTwoDay[0].orders|default='0'}</strong>
			                    <php>
			                   		$orders=$tjTwoDay[0]['orders']-$tjTwoDay[1]['orders'];
			                   		if($orders==0||!$tjTwoDay[1]['orders']){
			                   			
			                   		}elseif($orders>0){
			                   			echo '<strong class="fs12" style="color: red;">↑';
			                   			echo round($orders/$tjTwoDay[1]['orders']*100,2).'%</strong>';
			                   		}else{
			                   			echo '<strong class="fs12" style="color: green;">↓';
			                   			echo round($orders/$tjTwoDay[1]['orders']*100,2).'%</strong>';
			                   		}
			                   	</php>
			                </td>
			                <td class="text-left" style="border: 0;">	<strong class="fs18 pl5">{$tjTwoDay[0].orders_price|default='0'}</strong>
			                    <php>
			                   		$orders_price=$tjTwoDay[0]['orders_price']-$tjTwoDay[1]['orders_price'];
			                   		if($orders_price==0||!$tjTwoDay[1]['orders_price']){
			                   			
			                   		}elseif($orders_price>0){
			                   			echo '<strong class="fs12" style="color: red;">↑';
			                   			echo round($orders_price/$tjTwoDay[1]['orders_price']*100,2).'%</strong>';
			                   		}else{
			                   			echo '<strong class="fs12" style="color: green;">↓';
			                   			echo round($orders_price/$tjTwoDay[1]['orders_price']*100,2).'%</strong>';
			                   		}
			                   	</php>
			                </td>
			                <td class="text-left" style="border: 0;">	<strong class="fs18 pl5"><php>echo round($tjTwoDay[0]['orders']/$tjTwoDay[0]['hit']*100,2);</php>%</strong>
			                    <php>
			                   		$hitd=($tjTwoDay[0]['orders']/$tjTwoDay[0]['hit'])-($tjTwoDay[1]['orders']/$tjTwoDay[1]['hit']);
			                   		if($hitd==0||!($tjTwoDay[1]['orders']/$tjTwoDay[1]['hit'])){
			                   			
			                   		}elseif($hitd>0){
			                   			echo '<strong class="fs12" style="color: red;">↑';
			                   			echo round($hitd/($tjTwoDay[1]['orders']/$tjTwoDay[1]['hit'])*100,2).'%</strong>';
			                   		}else{
			                   			echo '<strong class="fs12" style="color: green;">↓';
			                   			echo round($hitd/($tjTwoDay[1]['orders']/$tjTwoDay[1]['hit'])*100,2).'%</strong>';
			                   		}
			                   	</php>
			                </td>
			            </tr>
			            <tr>
			                <td class="text-center h50 text-gray" style="border: 0;">前日</td>
			                <td class="text-left" style="border: 0;"><span class="fs16 pl8">{$tjTwoDay[1].show|default='0'}</span>
			                </td>
			                <td class="text-left" style="border: 0;"><span class="fs16 pl8">{$tjTwoDay[1].hit|default='0'}</span>
			                </td>
			                <td class="text-left" style="border: 0;"><span class="fs16 pl8"><php>echo round($tjTwoDay[1]['hit']/$tjTwoDay[1]['show']*100,2);</php>%</span>
			                </td>
			                <td class="text-left" style="border: 0;"><span class="fs16 pl8">{$tjTwoDay[1].orders|default='0'}</span>
			                </td>
			                <td class="text-left" style="border: 0;"><span class="fs16 pl8">{$tjTwoDay[1].orders_price|default='0'}</span>
			                </td>
			                <td class="text-left" style="border: 0;"><span class="fs16 pl8"><php>echo round($tjTwoDay[1]['orders']/$tjTwoDay[1]['hit']*100,2);</php>%</span>
			                </td>
			            </tr>
			        </table>
			    </div>
			    
			    <hr/>
			    
			    <div class="mt20">
			    	<div class="fs14">
						<strong>最近七天统计</strong>
					</div>
					<div id="Tjday" class="bg_white text-center" style="width: 100%; height: 400px;">
						<empty name="adstj">
							<br/>
	                		<span class="text_red">暂无数据</span>
	                	</empty>
					</div>
					<script src="/Public/new_design/js/amcharts.js" type="text/javascript"></script>
	    			<script src="/Public/new_design/js/serial.js" type="text/javascript"></script>
					<notempty name="adstj">
					<script>
						var chart;
						var chartData = [];
	
						AmCharts.ready(function () {
							// generate some random data first
							// generateChartData();
	
							// SERIAL CHART
							chart = new AmCharts.AmSerialChart();
	
							chart.dataProvider = eval({:json_encode($adstj)});
							// chart.dataProvider = chartData;
							// console.log(chart.dataProvider);
							chart.categoryField = "date";
	
							// listen for "dataUpdated" event (fired when chart is inited) and call zoomChart method when it happens
							// chart.addListener("dataUpdated", zoomChart);
	
							chart.synchronizeGrid = true; // this makes all axes grid to be at the same intervals
	
							// AXES
							// category
							var categoryAxis = chart.categoryAxis;
							// categoryAxis.parseDates = true; // as our data is date-based, we set parseDates to true
							categoryAxis.minPeriod = "DD"; // our data is daily, so we set minPeriod to DD
							// categoryAxis.minorGridEnabled = true;
							categoryAxis.axisColor = "#DADADA";
							categoryAxis.twoLineMode = true;
							categoryAxis.dateFormats = [{
								period: 'fff',
								format: 'JJ:NN:SS'
							}, {
								period: 'ss',
								format: 'JJ:NN:SS'
							}, {
								period: 'mm',
								format: 'JJ:NN'
							}, {
								period: 'hh',
								format: 'JJ:NN'
							}, {
								period: 'DD',
								format: 'DD'
							}, {
								period: 'WW',
								format: 'DD'
							}, {
								period: 'MM',
								format: 'MMM'
							}, {
								period: 'YYYY',
								format: 'YYYY'
							}];
	
							// first value axis (on the left)
							var valueAxis1 = new AmCharts.ValueAxis();
							valueAxis1.axisColor = "#FF6600";
							valueAxis1.axisThickness = 2;
							valueAxis1.offset = 50;
							valueAxis1.position = "left";
							chart.addValueAxis(valueAxis1);
	
							// second value axis (on the right)
							var valueAxis2 = new AmCharts.ValueAxis();
							valueAxis2.axisColor = "#FCD202";
							valueAxis2.gridAlpha = 0;
							valueAxis2.axisThickness = 2;
							valueAxis2.offset = 0;
							valueAxis2.position = "left";
							chart.addValueAxis(valueAxis2);
	
							// third value axis (on the left, detached)
							var valueAxis3 = new AmCharts.ValueAxis();
							valueAxis3.offset = 0; // this line makes the axis to appear detached from plot area
							valueAxis3.gridAlpha = 0;
							valueAxis3.axisColor = "#B0DE09";
							valueAxis3.axisThickness = 2;
							valueAxis3.position = "right";
							chart.addValueAxis(valueAxis3);
							
							var valueAxis4 = new AmCharts.ValueAxis();
							valueAxis4.offset = 50; // this line makes the axis to appear detached from plot area
							valueAxis4.gridAlpha = 0;
							valueAxis4.axisColor = "#2EA9DF";
							valueAxis4.axisThickness = 2;
							valueAxis4.position = "right"; // this line makes the axis to appear on the right
							chart.addValueAxis(valueAxis4);
	
							// GRAPHS
							// first graph
							var graph1 = new AmCharts.AmGraph();
							graph1.valueAxis = valueAxis1; // we have to indicate which value axis should be used
							graph1.title = "展现量";
							graph1.valueField = "show";
							graph1.bullet = "round";
							graph1.hideBulletsCount = 30;
							graph1.bulletBorderThickness = 1;
							chart.addGraph(graph1);
	
							// second graph
							var graph2 = new AmCharts.AmGraph();
							graph2.valueAxis = valueAxis2; // we have to indicate which value axis should be used
							graph2.title = "点击量";
							graph2.valueField = "hit";
							graph2.bullet = "square";
							graph2.hideBulletsCount = 30;
							graph2.bulletBorderThickness = 1;
							chart.addGraph(graph2);
	
							// third graph
							var graph3 = new AmCharts.AmGraph();
							graph3.valueAxis = valueAxis3; // we have to indicate which value axis should be used
							graph3.valueField = "orders";
							graph3.title = "成交笔数";
							graph3.bullet = "triangleUp";
							graph3.hideBulletsCount = 30;
							graph3.bulletBorderThickness = 1;
							chart.addGraph(graph3);
							
							var graph4 = new AmCharts.AmGraph();
							graph4.valueAxis = valueAxis4; // we have to indicate which value axis should be used
							graph4.valueField = "orders_price";
							graph4.title = "成交金额";
							graph4.bullet = "triangleDown";
							graph4.hideBulletsCount = 30;
							graph4.bulletBorderThickness = 1;
							chart.addGraph(graph4);
	
							// CURSOR
							var chartCursor = new AmCharts.ChartCursor();
							chartCursor.cursorAlpha = 0.1;
							chartCursor.fullWidth = true;
							chartCursor.valueLineBalloonEnabled = true;
							chart.addChartCursor(chartCursor);
	
							// SCROLLBAR
						   // var chartScrollbar = new AmCharts.ChartScrollbar();
							// chart.addChartScrollbar(chartScrollbar);
	
							// LEGEND
							var legend = new AmCharts.AmLegend();
							// legend.marginLeft = 110;
							legend.useGraphSettings = true;
							chart.addLegend(legend);
	
							// WRITE
							chart.write("Tjday");
						});
	
						// this method is called when chart is first inited as we listen for "dataUpdated" event
						function zoomChart() {
							// different zoom methods can be used - zoomToIndexes, zoomToDates, zoomToCategoryValues
							chart.zoomToIndexes(10, 20);
						}
					</script>
				</notempty>
				</div>
			    
			    <hr/>
			    
			    <div class="mb50 row mt20">
			        <div class="col-xs-6">
			            <div class="fs14"><strong>热门广告Top5</strong></div>
			            <table class="layui-table bg-white bor_der" lay-skin="nob">
			                <tr style="border-bottom: 1px solid #ccc;" class="h60">
			                    <th class="text-center" style="border: 0;width: 50px;">&nbsp;</th>
			                    <th class="text-center w225" style="border: 0;"><strong>广告详情</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>展示量</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>点击量</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>点击率</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>转化率</strong>
			                    </th>
			                </tr>
			                <tr><td colspan="6" style="border: 0;line-height: 0;">&nbsp;</td></tr>
			                <volist name="topAd" id="vo" key="key">
				                <tr>
				                    <td class="text-center" style="border: 0;"><strong>{$key}</strong>
				                    </td>
				                    <td class="text-center" style="border: 0;">
				                        <div class="fl">
				                        	<a href="{$vo.images}" title="大图" class="image-zoom">
				                            	<img src="{:myurl($vo['images'],80)}" class="mr5 bor_der" />
				                            </a>
				                        </div>
				                        <div class="">
				                        	<a href="{$vo.url}" target="_blank">
				                            	<p class="text-left fs14 pb5 over" style="height: 37px;">{$vo.name}</p>
				                            </a>
				                            <p class="text-left fs14 pb5">
				                            	<switch name="vo['type']">
				                            		<case value="0">商品</case>
				                            		<case value="1">店铺</case>
				                            		<case value="2">站外链接</case>
				                            	</switch>
				                            </p>
				                            <p class="text-left fs14">
				                            	<switch name="vo['device']">
				                            		<case value="1">PC</case>
				                            		<case value="2">WAP</case>
				                            	</switch>
				                            </p>
				                        </div>
				                    </td>
				                    <td class="text-center" style="border: 0;">{$vo.show}</td>
				                    <td class="text-center" style="border: 0;">{$vo.hit}</td>
				                    <td class="text-center" style="border: 0;"><php>echo round($vo['hit']/$vo['show']*100,2);</php>%</td>
				                    <td class="text-center" style="border: 0;"><php>echo round($vo['orders']/$vo['hit']*100,2);</php>%</td>
				                </tr>
			                </volist>
			            </table>
			        </div>
			        <div class="col-xs-6">
			            <div class="fs14"><strong>热门宝贝Top5</strong></div>
			            <table class="layui-table bg-white bor_der" lay-skin="nob">
			                <tr class="h60" style="border-bottom: 1px solid #ccc;">
			                    <th class="text-center" style="border: 0;width: 50px;">&nbsp;</th>
			                    <th class="text-center" style="border: 0;width: 250px;"><strong>广告详情</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>浏览量</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>成交量</strong>
			                    </th>
			                    <th class="text-center" style="border: 0;"><strong>成交金额（元）</strong>
			                    </th>
			                </tr>
			                <tr><td colspan="6" style="border: 0;line-height: 0;">&nbsp;</td></tr>
			                <volist name="topGoods" id="vo" key="key">
				                <tr>
				                    <td class="text-center" style="border: 0;"><strong>{$key}</strong>
				                    </td>
				                    <td class="text-center" style="border: 0;">
				                        <div class="fl">
				                        	<a href="{$vo.images}" title="大图" class="image-zoom">
				                            	<img src="{:myurl($vo['images'],80)}" class="mr5 bor_der" />
				                            </a>
				                        </div>
				                        <div class="">
				                        	<a href="{$vo.url}" target="_blank">
				                            	<p class="text-left fs14 pb5 over" style="height: 37px;">{$vo.goods_name}</p>
				                            </a>
				                            <p class="text-left fs14" style="color: red;">￥{$vo.price}元</p>
				                        </div>
				                    </td>
				                    <td class="text-center" style="border: 0;">{$vo.show}</td>
				                    <td class="text-center" style="border: 0;">{$vo.orders}</td>
				                    <td class="text-center" style="border: 0;border-right: 1px solid #ddd;">{$vo.orders_price}</td>
				                </tr>
			                </volist>
			            </table>
			        </div>
			    </div>
			    
			    
			    
			    
            </div>
        </div>
    </div>
</div>

<include file="Public:footer" />