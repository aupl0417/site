<form method="post" action="__URL__/export_file" role="form" class="p10 md10" id="export_set" target="_blank">
	<div class="alert alert-warning alert-white-alt2 rounded">
		<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
		<div class="icon"><i class="fa fa-warning"></i></div>
		<strong>提示：</strong> 单次最多可导出1000条记录。如果没有弹出下载窗口，请检查浏览器是否屏蔽了窗口弹出。
	</div>
	
	<table class="no-bordered no-bg">
		<tr>
			<td width="20%" class="text-right strong">订单状态</td>
			<td>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="1" {:in_array(1,$rs['status'])?'checked':''}> 退款</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="2" {:in_array(2,$rs['status'])?'checked':''}> 卖家拒绝</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="3" {:in_array(3,$rs['status'])?'checked':''}> 修改</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="4" {:in_array(4,$rs['status'])?'checked':''}> 同意</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="5" {:in_array(5,$rs['status'])?'checked':''}> 买家寄出商品</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="6" {:in_array(6,$rs['status'])?'checked':''}> 卖家寄出商品</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="10" {:in_array(10,$rs['status'])?'checked':''}> 买家可申诉</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="11" {:in_array(11,$rs['status'])?'checked':''}> 卖家未收到退货</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="12" {:in_array(12,$rs['status'])?'checked':''}> 买家未收到货</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="20" {:in_array(20,$rs['status'])?'checked':''}> 退款已取消</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="status[]" id="status[]" value="100" {:in_array(100,$rs['status'])?'checked':''}> 退款已完成</label>
			</td>
		</tr>
		<tr>
			<td width="20%" class="text-right strong">退款类型</td>
			<td>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="type[]" id="type[]" value="1" {:in_array(1,$rs['type'])?'checked':''}> 退货退款</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="type[]" id="type[]" value="2" {:in_array(2,$rs['type'])?'checked':''}> 只退款</label>
				<label class="mr10"><input type="checkbox" class="i-red-square" name="type[]" id="type[]" value="3" {:in_array(3,$rs['type'])?'checked':''}> 退运费</label>
			</td>
		</tr>
		<tr>
			<td width="20%" class="text-right strong">时间类型</td>
			<td>
				<label class="mr10"><input type="radio" class="i-red-square" name="day_field" id="day_field" value="atime" {$rs['day_field']=='atime'?'checked':''}> 申请退款时间</label>
				<label class="mr10"><input type="radio" class="i-red-square" name="day_field" id="day_field" value="cancel_time" {$rs['day_field']=='cancel_time'?'checked':''}> 取消退款时间</label>
				<label class="mr10"><input type="radio" class="i-red-square" name="day_field" id="day_field" value="accept_time" {$rs['day_field']=='accept_time'?'checked':''}> 同意退款时间</label>
				<label class="mr10"><input type="radio" class="i-red-square" name="day_field" id="day_field" value="express_time" {$rs['day_field']=='express_time'?'checked':''}> 寄回退货时间</label>
			</td>
		</tr>
		<tr>
			<td width="20%" class="text-right strong">时间区间</td>
			<td>
				<div class="row">
					<div class="col-xs-3">
						<input type="text" id="sday" name="sday" placeholder="请输入时间从" value="{$rs.sday}" class="form-control datepicker " style="" data-date-format="yyyy-mm-dd">					
					</div>
					<div class="col-xs-3">
						<input type="text" id="eday" name="eday" placeholder="请输入时间至" value="{$rs.eday}" class="form-control datepicker " style="" data-date-format="yyyy-mm-dd">					
					</div>
					<div class="col-xs-3">
						<div class="btn btn-default" onclick="$('#export_set #sday,#export_set #eday').val('');"><i class="fa fa-times"></i>清除时间</div>
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td width="20%" class="text-right strong">数据类型</td>
			<td>
				<label class="mr10"><input type="radio" class="i-red-square" name="num_field" id="num_field" value="money" {$rs['num_field']=='money'?'checked':''}> 退款金额</label>
				<label class="mr10"><input type="radio" class="i-red-square" name="num_field" id="num_field" value="num" {$rs['num_field']=='num'?'checked':''}> 退货数量</label>
				
			</td>
		</tr>
		<tr>
			<td width="20%" class="text-right strong">金额区间</td>
			<td>
				<div class="row">
					<div class="col-xs-3">
						<input type="text" id="snum" name="snum" placeholder="请输入金额从" value="{$rs.snum}" class="form-control " style="">					
					</div>
					<div class="col-xs-3">
						<input type="text" id="enum" name="enum" placeholder="请输入金额至" value="{$rs.enum}" class="form-control " style="">					
					</div>
				</div>			
			</td>
		</tr>
		
		<tr>
			<td width="20%" class="text-right strong">卖家昵称</td>
			<td>
				<input type="text" id="nick" name="nick" placeholder="请输入卖家昵称" value="{$rs.nick}" class="form-control " style="width:400px">
			</td>
		</tr>
		<tr>
			<td width="20%" class="text-right strong">店铺名称</td>
			<td>
				<input type="text" id="shop_name" name="shop_name" placeholder="请输入店铺名称" value="{$rs.shop_name}" class="form-control " style="width:400px">
			</td>
		</tr>	
		<tr>
			<td width="20%" class="text-right strong">导出字段</td>
			<td>
				<div style="max-height:300px;overflow:auto" class="box p20">
					<div class="row export_field">
					<volist name="rs.field" id="fid">
						<volist name="fcfg.allfields" id="vo">
							<eq name="vo.id" value="$fid">
							<div class="col-xs-2">
							<label class="mr10"><input type="checkbox" class="i-red-square" name="field[]" id="field[]" value="{$vo.id}" checked> {$vo.label}</label>
							</div>
							</eq>
						</volist>					
					</volist>
					
					<volist name="fcfg.allfields" id="vo">
						<notin name="vo.id" value="$rs.field">
						<div class="col-xs-2">
						<label class="mr10"><input type="checkbox" class="i-red-square" name="field[]" id="field[]" value="{$vo.id}"> {$vo.label}</label>
						</div>
						</notin>
					</volist>
					</div>
				</div>
				<div class="text-gray p10">拖动字段可进行排序</div>
			</td>
		</tr>			
	</table>
	

	
	<div class="p10 text-center">
		<button type="submit" class="btn btn-primary btn-150px hide">保存设置并导出</button>
		<button type="button" class="btn btn-primary btn-150px" onclick = "export_file()">保存设置并导出</button>
	</div>
	

</form>
<div class="clearfix"></div>

<script>
iCheckClass('#export_set');
$('#export_set .datepicker').datetimepicker({
	format:'Y-m-d',
	timepicker:false,
});

//排序
$('#export_set .export_field').sortable({
	stop: function(event, ui) {}
});

function export_file(){
	var data = getFormJson('#export_set');
	if($('input[name="field[]"]:checked').length < 8){
		valert({'status':'warning','msg':'请勾选8个字段以上'});
		return false;
	}
	ajax_post({
		url:'__URL__/export_set_save',
		data:data,
	},function(ret){
		if(ret.status == 'success'){
			$("#export_set").submit();
		}else{
			valert(ret);
		}
		
	});
	
	return false;
}
</script>